work_dir: ./work_dir/SHREC/hyperhand_bone_final

# [Model Configuration]
model: net.dsa_hgn.DualBranchDSA_HGN
model_args:
  in_channels: 3
  base_channels: 64
  ch_ratio: 2
  num_stages: 10
  inflate_stages: [ 5, 8 ]
  down_stages: [ 5, 8 ]
  data_bn_type: 'VC'
  num_person: 1
  pretrained: None
  num_class: 14
  num_point: 22
  # [OPTIMIZATION] SHREC 数据集较小，提高 Dropout 防止过拟合
  drop_out: 0.4
  graph: graph.shrec.Graph
  graph_args:
    labeling_mode: 'spatial'
  num_hyperedges: 16
  adaptive: true
  # [FEATURE] 启用虚拟连接（需配合修改后的 net/dsa_hgn.py）
  use_virtual_conn: True

# [Feeder Configuration]
train_feeder: feeder.feeder_egogesture.Feeder
test_feeder: feeder.feeder_egogesture.Feeder

train_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_label.pkl
  split: train

  # [CRITICAL FIX] 必须设为 False！
  # DualBranch 模型内部会计算差分。如果这里设为 True，会导致 "Bone of Bone" 错误。
  # 保持 stream: joint 即可，模型会自动分支出 Bone 流。
  bone: False
  vel: False

  window_size: 180
  normalization: False     # 保留物理幅值（对于 SHREC 是合理的）
  random_choose: True
  random_move: False
  random_shift: False
  repeat: 5
  debug: False
  use_mmap: True

test_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_label.pkl
  split: test

  # [CRITICAL FIX] 同上，必须设为 False
  bone: False
  vel: False

  window_size: 180
  normalization: False
  debug: False
  use_mmap: True

# [Optimization Configuration]
weight_decay: 0.0005
base_lr: 0.05
lr_decay_rate: 0.1
step: [70, 100]
warm_up_epoch: 5
num_epoch: 150
device: [0]
batch_size: 32
test_batch_size: 32
nesterov: True
grad_clip_norm: 1.0
loss: torch.nn.CrossEntropyLoss

# [Paper A SOTA Hyperparameters]
# 激活 recognition.py 中的 Paper A 专属损失函数
lambda_sparsity: 0.01  # 控制 STE 剪枝的稀疏度
lambda_ortho: 0.1      # 控制超边原型的多样性

# [System/Log Optimization]
# 解决 Mac MPS 上日志输出间隔过长导致的“假死”现象
log_interval: 10
# 解决 Mac 上 DataLoader 多进程死锁问题
num_worker: 0