work_dir: ./work_dir/SHREC/hyperhand_bone_v4

# 1. 权重: null 表示从头训练 (务必清空)
weights: null

# 2. 模型定义 (HyperHand 核心结构)
model: net.ctrgcn.Model
model_args:
  in_channels: 3
  num_class: 14
  num_point: 22
  num_person: 1
  drop_out: 0.6            # ⬆️ 高 DropOut 防止过拟合
  graph: graph.shrec.Graph
  graph_args:
    labeling_mode: 'spatial'
  num_hyperedges: 16       # ✅ Paper 1 核心创新: 动态超图
  adaptive: True

# 3. 数据流: Bone (骨骼)
train_feeder: feeder.feeder_egogesture.Feeder
test_feeder: feeder.feeder_egogesture.Feeder

train_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_label.pkl
  split: train
  bone: True               # ✅ 核心: 开启骨骼模式
  vel: False
  window_size: 64          # ⬆️ 增大窗口至 64
  p_interval: [0.5, 1]     # 数据增强: 随机裁剪
  shear_amplitude: 0.2
  temperal_padding_ratio: 6
  random_rot: True
  random_choose: True
  random_move: False       # 骨骼数据不需要平移增强
  random_shift: True
  normalization: True      # 骨骼数据必须归一化
  debug: False
  use_mmap: True

test_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_label.pkl
  split: test
  bone: True               # ✅ 保持一致
  vel: False
  window_size: 64
  normalization: True
  debug: False
  use_mmap: True

# 4. 优化策略 (AdamW 稳健版)
optimizer: AdamW
base_lr: 0.0002
weight_decay: 0.05         # 适度正则化
step: [45, 60]        # 学习率衰减点
num_epoch: 80             # ⬆️ 延长训练周期

# 5. 显存安全配置 (关键修复)
device: [0]
batch_size: 32             # ⬅️ 必须是 32，防止 OOM
test_batch_size: 32        # ⬅️ 必须是 32
nesterov: True
grad_clip_norm: 1.0        # 梯度裁剪，防止爆炸

# 6. 损失函数 (Label Smoothing)
loss: torch.nn.CrossEntropyLoss
loss_args:
  label_smoothing: 0.1     # ✅ 关键提分点

# 7. 其他
num_worker: 4
use_gpu: True
log_interval: 100
save_interval: 1
eval_interval: 1
save_result: True